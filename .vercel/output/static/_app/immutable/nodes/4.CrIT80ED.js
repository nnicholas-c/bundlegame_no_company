import{t as u,a as l,c as pt,d as cr}from"../chunks/B3TvFCtC.js";import{i as yt}from"../chunks/C4K_aaoz.js";import{p as kt,m as f,b as o,g as e,af as ie,ag as Ot,c as r,r as t,s,a9 as y,a as St,f as Je,ah as ct,ai as Ut,u as J,a5 as vr,j as ur}from"../chunks/Cao0yY2J.js";import{s as c}from"../chunks/Cf6y-89_.js";import{_ as zt,i as k}from"../chunks/DjcyRQET.js";import{e as Le}from"../chunks/B7PLFFmE.js";import{s as w,a as Tt,b as ft,c as Fe,p as Lt}from"../chunks/C3L_Nxjf.js";import{e as $e,i as Ie,s as st,a as Vt,b as pr,g as fr}from"../chunks/Ddsu3cQT.js";import{I as mr,J as xr,K as gr,L as br,M as _r,s as ut,r as Ht,c as Zt,b as Wt,q as Xt,w as Yt}from"../chunks/EKw1ix6C.js";import{d as Dt,w as fe,g as pe}from"../chunks/Ir3_mycn.js";import{o as jt,a as At}from"../chunks/B0XkOfBH.js";const hr="Tutorial",$r=120,wr=2,yr=2,kr=!1,Or=!1,Sr=!1,Tr=!1,jr=[{name:"Tutorial",order_file:"order.json",store_file:"stores.json"}],Cr=!1,De={name:hr,timeLimit:$r,thinkTime:wr,gridSize:yr,tips:kr,waiting:Or,refresh:Sr,expire:Tr,conditions:jr,auth:Cr},ht=Object.assign({"./tutorialconfigs/order.json":()=>zt(()=>import("../chunks/CkKTrVy-.js"),[],import.meta.url),"./tutorialconfigs/stores.json":()=>zt(()=>import("../chunks/DhlARntI.js"),[],import.meta.url)});Object.keys(ht).map(x=>({name:x.split("/").pop(),importFn:ht[x]}));let Et={},Jt=[],er,_t;const Rt=fe(0),at=fe([]),vt=De.timeLimit,Ir=De.gridSize,$t=fe(1),Mt=_r,tr=fe(0);function Pt(x){return Mt.find(_=>_.round===x)??Mt[Mt.length-1]}const qt=fe(!1),rt=fe({selector:"None selected"}),Kt=De.thinkTime,Lr=4,Ae=fe({inSelect:!1,inStore:!1,bundled:!1,tip:De.tips,waiting:De.waiting,refresh:De.refresh});function Er(){er=new Date}let Bt;const rr=fe(new Date),Mr=()=>(Bt=setInterval(()=>{rr.set(new Date)},10),_t=()=>clearInterval(Bt),function(){clearInterval(Bt)});let Br=0;const sr=Dt(rr,x=>x.getTime()-er-Br);sr.subscribe(x=>{pe(qt)});const Re=fe([]),Gt=fe([]),Rr=fe(""),wt=fe(0),nt=fe(""),Nt=Dt(sr,(x,_)=>{const v=Math.round(x/1e3);if(v>=vt&&v<=vt+2){mr(pe(Rr),{earnings:pe(wt),ordersComplete:pe(Gt).length,uniqueSetsComplete:pe(Rt),gametime:vt}),qt.set(!0),_t==null||_t(),_(vt),console.log("game over");return}_(v)}),Dr=Dt(Nt,x=>Math.max(vt-x,0)),Ar=x=>{},Pr=(x,_)=>{},qr=x=>{};async function Qt(x){const _=Object.keys(ht).find(Pe=>Pe.endsWith(x));return _?(await ht[_]()).default:(console.error(`Config file "${x}" not found in ../configs/`),null)}async function Gr(){let x=0;if(De.conditions.length>1){let _=await xr();await gr(),x=_%De.conditions.length}try{let _=await Qt(De.conditions[x].order_file),v=await Qt(De.conditions[x].store_file);!_||!v?console.error("Could not find files specified in configuration"):(Et=v,Jt=_)}catch(_){return console.error("Error creating conditions",_),-1}return nt.set(Et.startinglocation),br(Jt,Et),x}var Nr=u('<p class="text-xs text-green-600"> </p>'),Fr=u('<span class="rounded-full bg-emerald-50 px-2 py-0.5 font-medium text-emerald-700">Picking items</span>'),zr=u('<span class="rounded-full bg-blue-50 px-2 py-0.5 font-medium text-blue-700">Moving...</span>'),Vr=u('<span class="rounded-full bg-slate-100 px-2 py-0.5 font-medium text-slate-700"> </span>'),Hr=u("<li> </li>"),Wr=u('<div class="flex-1 min-w-[180px] rounded-lg bg-slate-50 p-3 text-xs"><p class="font-semibold text-slate-900 mb-1"> </p> <p class="text-slate-600 mb-2"> </p> <ul class="space-y-0.5 text-slate-600"></ul></div>'),Yr=u('<div class="text-center py-8"><button class="rounded-full bg-green-600 px-8 py-3 text-sm font-semibold text-white shadow-md hover:bg-green-700 transition" id="startpicking"> </button></div>'),Jr=u('<span class="ml-1 rounded-full bg-slate-200 px-1.5 py-0.5 text-[9px]"> </span>'),Kr=u("<button> <!></button>"),Qr=u('<li class="flex justify-between"><span> </span> <span class="font-medium"> </span></li>'),Ur=u('<li class="text-slate-400 italic text-[10px]">Empty</li>'),Zr=u('<div><h5 class="text-xs font-medium text-slate-700 mb-1"> </h5> <ul class="text-xs text-slate-600 space-y-0.5 pl-2"><!> <!></ul></div>'),Xr=u('<input class="rounded-lg border border-slate-200 px-2 py-1.5 text-xs placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-green-500" type="number">'),es=u('<span class="text-lg"> </span>'),ts=u('<button id="moveinstore"><span> </span> <!></button>'),rs=u('<div class="grid md:grid-cols-[2fr,3fr] gap-4"><section class="rounded-2xl bg-white shadow-sm border p-4 space-y-3"><div class="flex gap-1 border-b pb-2"></div> <div class="space-y-3"></div> <div class="pt-3 border-t space-y-2"><input class="w-full rounded-lg border border-slate-200 px-3 py-1.5 text-xs placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Item name"> <div class="grid gap-2"></div> <button id="addtobag" class="w-full rounded-lg bg-blue-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-blue-700 transition">Add to bags</button></div></section> <section class="rounded-2xl bg-white shadow-sm border p-4 space-y-3"><h3 class="text-sm font-semibold text-slate-900">Store layout</h3> <div></div></section></div> <footer class="sticky bottom-0 mt-4 rounded-2xl border border-slate-200 bg-white/95 backdrop-blur shadow-lg"><div class="flex items-center justify-between px-4 py-3"><div class="text-xs text-slate-600"><p>Items: <!></p></div> <button id="checkout" class="rounded-full bg-green-600 px-6 py-2 text-sm font-semibold text-white shadow-md hover:bg-green-700 transition">Checkout and Exit</button></div></footer>',1),ss=u('<div class="rounded-2xl bg-blue-50 border border-blue-200 p-6 text-center space-y-2"><div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 mb-2"><svg class="w-6 h-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg></div> <h3 class="text-sm font-semibold text-blue-900"> </h3> <p class="text-xs text-blue-700"> </p></div>'),as=u('<div class="rounded-2xl bg-green-50 border border-green-200 p-6 text-center space-y-4"><div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100"><svg class="w-8 h-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <div><p class="text-lg font-semibold text-green-900">Order Complete!</p> <p class="text-sm text-green-700">All items collected correctly</p> <p class="text-xs text-slate-500 mt-2"> </p></div> <button class="rounded-full bg-green-600 px-6 py-2 text-sm font-semibold text-white shadow-md hover:bg-green-700 transition" id="ordersuccess">Next Round â†’</button></div>'),ns=u('<div class="rounded-2xl bg-red-50 border border-red-200 p-6 text-center space-y-4"><div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-100"><svg class="w-8 h-8 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></div> <div><p class="text-lg font-semibold text-red-900">Incorrect Items</p> <p class="text-sm text-red-700">Please check your bags and try again</p></div> <button class="rounded-full bg-red-600 px-6 py-2 text-sm font-semibold text-white shadow-md hover:bg-red-700 transition" id="orderretry">Try Again</button></div>'),os=u('<main class="mx-auto max-w-5xl px-4 py-6 space-y-5"><section class="rounded-2xl bg-white shadow-sm border p-4 space-y-3"><div class="flex items-start justify-between"><div><h2 class="text-base font-semibold text-slate-900"> </h2> <p class="text-xs text-slate-500"> </p></div> <div class="text-right text-sm"><p class="font-semibold text-slate-900"> </p> <!> <p class="text-xs text-slate-500"> </p></div></div> <div class="flex flex-wrap gap-2 text-[10px]"><!> <!></div> <div class="flex flex-wrap gap-2"></div></section> <!></main>');function is(x,_){kt(_,!1);const[v,Pe]=Tt(),S=()=>w(Re,"$orders",v),A=()=>w(Nt,"$elapsed",v),b=()=>w(Ae,"$game",v),we=()=>w(wt,"$earned",v),me=()=>w(Rt,"$uniqueSets",v),xe=()=>w(Gt,"$finishedOrders",v),Ee=()=>w($t,"$currentRound",v),ne=()=>w(tr,"$roundStartTime",v),j=f(),m=f(),F=f(),ge=f();let g=f(ut(S()[0].store)),T=f(0),h=f([0,0]),$=f([{},{},{}]),z=f(0),le=f(["","",""]),C=f(""),X=f(0),re=!1,be=f(A()),de,se,a=f(),p=f(0);function M(){let n=Math.floor(e(m)/e(g).tipinterval),i=n<e(g).tip.length?1+e(g).tip[n]/100:e(g).tip[e(g).tip.length-1]/100;o(p,Math.round(i*100-100)),o(a,Math.round(se*i*100)/100)}let V={1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6",7:"grid-cols-7",8:"grid-cols-8",9:"grid-cols-9"}[Ir];jt(()=>{se=pe(Re).reduce((i,d)=>i+d.earnings,0),o(a,se),o(g,ut(S()[0].store)),o(h,e(g).Entrance),b().tip&&(de=setInterval(M,1e3))}),At(()=>{b().tip&&clearInterval(de)});function L(n,i,d){n!=""&&(o(X,Math.abs(i-e(h)[0])+Math.abs(d-e(h)[1])),ct(h,e(h)[0]=i),ct(h,e(h)[1]=d),o(T,2),setTimeout(()=>{o(T,1)},e(X)*e(g).cellDistance))}function H(){pe(Re);let n=e(g).locations[e(h)[0]][e(h)[1]].toLowerCase();if(n==""||n=="entrance")return;if(e(C),e(z)+1,e($).map(d=>({...d})),e(C).toLowerCase()!=n.toLowerCase()){alert("Incorrect! You must type the name of the item"),o(C,""),o(le,["","",""]);return}let i=[];for(let d=0;d<e(j);d++){let O=e(le)[d].trim();if(O==="")i.push(0);else{let Q=parseInt(O);if(isNaN(Q)){alert("Error: Quantity inputs must be numbers"),o(C,""),o(le,["","",""]);return}i.push(Q)}}for(let d=0;d<e(j);d++)i[d]!==0&&(Object.keys(e($)[d]).includes(n)?ct($,e($)[d][n]+=i[d]):ct($,e($)[d][n]=i[d]),e($)[d][n]<=0&&delete e($)[d][n]);o(C,""),o(le,["","",""]),o($,e($))}function q(){const n=pe(Re);o(be,A()),o(g,ut(n[0].store)),o(T,1)}function ye(){o(T,0),Fe(Ae,J(b).inSelect=!0,J(b)),Fe(Ae,J(b).inStore=!1,J(b))}function K(){const n=pe(Re),i=n.length;function d(E){if(E.length<=1)return[E];const N=[];for(let Y=0;Y<E.length;Y++){const U=[...E.slice(0,Y),...E.slice(Y+1)],ee=d(U);for(const Z of ee)N.push([E[Y],...Z])}return N}const O=Array.from({length:i},(E,N)=>N),Q=d(O);re=!1;for(const E of Q){let N=!0;for(let Y=0;Y<i;Y++){const U=E[Y],ee=n[U],Z=e($)[Y];if(Object.keys(Z).length!==Object.keys(ee.items).length){N=!1;break}for(const oe of Object.keys(Z))if(ee.items[oe]!==Z[oe]){N=!1;break}if(!N)break}if(N){re=!0;break}}if(o($,[{},{},{}]),re){ce(!0),ft(wt,we()+e(a)),ft(Rt,me()+1),n.forEach(E=>{qr(E.id),xe().push(E)});for(let E=0;E<i;E++)S().shift();o(T,3)}else ce(!1),o(T,4)}function ce(n){const i=Pt(Ee());A()-ne();const d=S().map(O=>O.id);i.orders.filter(O=>O.recommended).map(O=>O.id),Ar({round_index:Ee(),phase:i.phase,scenario_id:i.scenario_id,available_orders:i.orders.map(O=>O.id),bundle_size:d.length,round_earnings:n?e(a):0,gametime_elapsed_s:A()}),n&&$t.update(O=>O+1)}ie(()=>S(),()=>{o(j,S().length)}),ie(()=>(A(),e(be)),()=>{o(m,A()-e(be))}),ie(()=>e($),()=>{o(F,e($).map(n=>Object.values(n).reduce((i,d)=>i+d,0)))}),ie(()=>(e(g),e(h)),()=>{var n,i;o(ge,((i=(n=e(g).locations)==null?void 0:n[e(h)[0]])==null?void 0:i[e(h)[1]])||"Entrance")}),Ot(),yt();var ve=os(),_e=r(ve),W=r(_e),ae=r(W),I=r(ae),R=r(I,!0);t(I);var G=s(I,2),ue=r(G);t(G),t(ae);var ke=s(ae,2),qe=r(ke),he=r(qe);t(qe);var Me=s(qe,2);{var ze=n=>{var i=Nr(),d=r(i);t(i),y(()=>c(d,`+${e(p)??""}% tip`)),l(n,i)};k(Me,n=>{b().tip&&e(p)>0&&n(ze)})}var Ve=s(Me,2),Ke=r(Ve);t(Ve),t(ke),t(W);var Oe=s(W,2),He=r(Oe);{var Ct=n=>{var i=Fr();l(n,i)},Se=(n,i)=>{{var d=O=>{var Q=zr();l(O,Q)};k(n,O=>{e(T)===2&&O(d)},i)}};k(He,n=>{e(T)===1?n(Ct):n(Se,!1)})}var We=s(He,2);{var ot=n=>{var i=Vr(),d=r(i);t(i),y(()=>c(d,`Time in store: ${e(m)??""}s`)),l(n,i)};k(We,n=>{(e(T)==1||e(T)==2)&&n(ot)})}t(Oe);var mt=s(Oe,2);$e(mt,5,S,Ie,(n,i,d)=>{var O=Wr(),Q=r(O),E=r(Q);t(Q);var N=s(Q,2),Y=r(N);t(N);var U=s(N,2);$e(U,5,()=>Object.keys(e(i).items),Ie,(ee,Z)=>{var oe=Hr(),te=r(oe);t(oe),y(()=>c(te,`${e(i).items[e(Z)]??""}x ${e(Z)??""}`)),l(ee,oe)}),t(U),t(O),y(()=>{c(E,`Order ${d+1} for ${e(i).name??""}`),c(Y,`Pay: $${e(i).earnings??""}`)}),l(n,O)}),t(mt),t(_e);var ar=s(_e,2);{var nr=n=>{var i=Yr(),d=r(i),O=r(d);t(d),t(i),y(()=>c(O,`Start Picking (${e(j)??""} ${e(j)===1?"Order":"Orders"})`)),Le("click",d,q),l(n,i)},or=(n,i)=>{{var d=Q=>{var E=rs(),N=Je(E),Y=r(N),U=r(Y);$e(U,5,()=>Array(e(j)),Ie,(je,et,B)=>{var D=Kr(),Be=r(D);Be.nodeValue=`Bag ${B+1} `;var it=s(Be);{var Ge=Ne=>{var Ce=Jr(),Qe=r(Ce,!0);t(Ce),y(()=>c(Qe,e(F)[B])),l(Ne,Ce)};k(it,Ne=>{e(F)[B]>0&&Ne(Ge)})}t(D),y(()=>st(D,1,`flex-1 rounded-t-lg px-3 py-1.5 text-xs font-medium transition ${e(z)===B?"bg-green-100 text-green-700":"bg-slate-50 text-slate-600 hover:bg-slate-100"}`)),Le("click",D,()=>o(z,B)),l(je,D)}),t(U);var ee=s(U,2);$e(ee,5,()=>Array(e(j)),Ie,(je,et,B)=>{var D=Zr(),Be=r(D),it=r(Be);t(Be);var Ge=s(Be,2),Ne=r(Ge);$e(Ne,1,()=>Object.keys(e($)[B]),Ie,(Ue,tt)=>{var lt=Qr(),Ze=r(lt),dt=r(Ze,!0);t(Ze);var bt=s(Ze,2),dr=r(bt,!0);t(bt),t(lt),y(()=>{c(dt,e(tt)),c(dr,e($)[B][e(tt)])}),l(Ue,lt)});var Ce=s(Ne,2);{var Qe=Ue=>{var tt=Ur();l(Ue,tt)};k(Ce,Ue=>{Object.keys(e($)[B]).length===0&&Ue(Qe)})}t(Ge),t(D),y(()=>c(it,`Bag ${B+1} - ${S()[B].name??""}`)),l(je,D)}),t(ee);var Z=s(ee,2),oe=r(Z);Ht(oe);var te=s(oe,2);$e(te,5,()=>Array(e(j)),Ie,(je,et,B)=>{var D=Xr();Ht(D),Zt(D,"placeholder",`Bag ${B+1}`),Wt(D,()=>e(le)[B],Be=>ct(le,e(le)[B]=Be)),l(je,D)}),t(te);var Te=s(te,2);t(Z),t(Y);var Ye=s(Y,2),Xe=s(r(Ye),2);st(Xe,1,`grid gap-2 ${V}`),$e(Xe,5,()=>e(g).locations,Ie,(je,et,B)=>{var D=pt(),Be=Je(D);$e(Be,1,()=>e(et),Ie,(it,Ge,Ne)=>{var Ce=ts(),Qe=r(Ce),Ue=r(Qe,!0);t(Qe);var tt=s(Qe,2);{var lt=Ze=>{var dt=es(),bt=r(dt,!0);t(dt),y(()=>c(bt,Vt[e(Ge)])),l(Ze,dt)};k(tt,Ze=>{Vt[e(Ge)]&&Ze(lt)})}t(Ce),y(()=>{st(Ce,1,`flex min-h-[60px] flex-col items-center justify-center rounded-xl text-xs font-medium transition ${B===e(h)[0]&&Ne===e(h)[1]?"bg-green-100 border-2 border-green-500 text-green-900":"border border-slate-200 bg-slate-50 text-slate-800 hover:bg-slate-100"}`),c(Ue,e(Ge))}),Le("click",Ce,()=>L(e(Ge),B,Ne)),l(it,Ce)}),l(je,D)}),t(Xe),t(Ye),t(N);var xt=s(N,2),gt=r(xt),It=r(gt),Ft=r(It),ir=s(r(Ft));$e(ir,1,()=>e(F),Ie,(je,et,B)=>{Ut();var D=cr();y(()=>c(D,`Bag ${B+1} (${e(et)??""})${B<e(j)-1?" Â· ":""}`)),l(je,D)}),t(Ft),t(It);var lr=s(It,2);t(gt),t(xt),y(()=>pr(te,`grid-template-columns: repeat(${e(j)??""}, 1fr);`)),Wt(oe,()=>e(C),je=>o(C,je)),Le("click",Te,H),Le("click",lr,K),l(Q,E)},O=(Q,E)=>{{var N=U=>{var ee=ss(),Z=s(r(ee),2),oe=r(Z);t(Z);var te=s(Z,2),Te=r(te);t(te),t(ee),y(()=>{c(oe,`Walking to ${e(g).locations[e(h)[0]][e(h)[1]]??""}`),c(Te,`Travel time: ${e(X)*e(g).cellDistance/1e3}s`)}),l(U,ee)},Y=(U,ee)=>{{var Z=te=>{var Te=as(),Ye=s(r(Te),2),Xe=s(r(Ye),4),xt=r(Xe);t(Xe),t(Ye);var gt=s(Ye,2);t(Te),y(()=>c(xt,`Round ${Ee()-1} finished`)),Le("click",gt,ye),l(te,Te)},oe=te=>{var Te=ns(),Ye=s(r(Te),4);t(Te),Le("click",Ye,q),l(te,Te)};k(U,te=>{e(T)==3?te(Z):te(oe,!1)},ee)}};k(Q,U=>{e(T)==2?U(N):U(Y,!1)},E)}};k(n,Q=>{e(T)==1?Q(d):Q(O,!1)},i)}};k(ar,n=>{e(T)==0?n(nr):n(or,!1)})}t(ve),y(()=>{c(R,S()[0].store),c(ue,`Current location: ${e(ge)??""}`),c(he,`Total earnings: $${e(a)??""}`),c(Ke,`Orders: ${e(j)??""}`)}),l(x,ve),St(),Pe()}var ls=u('<div class="rounded-2xl bg-red-50 border border-red-200 shadow-sm p-4"><p class="text-sm font-semibold text-red-800 text-center"> </p> <p class="text-xs text-red-600 text-center mt-1">Waiting for new order...</p></div>'),ds=u('<div class="absolute top-3 right-3 rounded-full bg-emerald-50 px-2.5 py-1 text-[10px] font-semibold text-emerald-700 flex items-center gap-1 shadow-sm"><span class="inline-block h-2 w-2 rounded-full bg-emerald-500"></span> Recommended</div>'),cs=u('<span class="rounded-full bg-amber-100 px-2 py-0.5 text-[10px] font-medium text-amber-800">High demand</span>'),vs=u('<p class="truncate"> </p>'),us=u('<div><!> <div class="flex flex-col gap-3 p-4"><div class="flex items-start justify-between gap-3"><div><p class="text-sm font-semibold text-slate-900"> </p> <p class="text-xs text-slate-500"> </p></div> <div><span class="rounded-full bg-blue-100 px-2 py-0.5 text-[10px] font-medium text-blue-800">Batch</span> <!></div></div> <div class="flex items-baseline gap-2"><p class="text-xs text-slate-500">Pay</p> <p class="text-lg font-semibold text-slate-900"> </p></div> <div class="flex justify-between gap-4"><div class="space-y-0.5 text-xs text-slate-600 flex-1"><p> </p> <p> </p> <p> </p></div> <div class="text-right text-xs text-slate-600 max-w-[120px]"></div></div> <div class="mt-2 flex justify-end"><button type="button"> </button></div></div></div>');function ps(x,_){kt(_,!1);const[v,Pe]=Tt(),S=()=>w($t,"$currentRound",v),A=()=>w(Ae,"$game",v),b=()=>w(Re,"$orders",v),we=()=>w(at,"$orderList",v),me=()=>w(nt,"$currLocation",v),xe=()=>w(rt,"$gameText",v),Ee=f(),ne=f(),j=f();let m=Lt(_,"orderData",12),F=Lt(_,"index",8),ge=Lt(_,"updateEarnings",8),g=f(!1),T=0,h,$=f(!1),z=ut(m().store);function le(){if(T+=1,A().waiting){let a=Math.floor(T/z.waitinginterval),p=a<z.waiting.length?1+z.waiting[a]/100:z.waiting[z.waiting.length-1]/100;m(m().earnings=Math.round(m().startingearnings*p*100)/100,!0),ge()(F(),m().earnings)}if(A().refresh&&m().demand>Math.random()*100){if(e(g)){for(let a=0;a<b().length;a++)if(b()[a].id==m().id){b().splice(a,1);break}o(g,!1)}o($,!0),setTimeout(C,z.refresh*1e3)}}function C(){clearInterval(h),ft(at,[...we(),...Xt(1)]),we().splice(F(),1)}jt(()=>{(A().waiting||A().refresh)&&(T=0,z=ut(m().store),h=setInterval(le,1e3))}),At(()=>{(A().waiting||A().refresh)&&(clearInterval(h),T=0)});function X(){if(e(g)){for(let a=0;a<b().length;a++)if(b()[a].id==m().id){b().splice(a,1);break}o(g,!1)}else{if(b().length>=e(j))return;b().push(m()),o(g,!0)}b().length>0?b()[0].city==me()?Fe(rt,J(xe).selector=`Go to store (${b().length} ${b().length===1?"order":"orders"})`,J(xe)):Fe(rt,J(xe).selector=`Travel to ${b()[0].city} (${b().length} ${b().length===1?"order":"orders"})`,J(xe)):Fe(rt,J(xe).selector="None selected",J(xe)),console.log(b())}ie(()=>vr(m()),()=>{o(Ee,Object.values(m().items||{}).reduce((a,p)=>a+p,0))}),ie(()=>S(),()=>{o(ne,Pt(S()))}),ie(()=>e(ne),()=>{o(j,e(ne).max_bundle??3)}),Ot(),yt();var re=pt(),be=Je(re);{var de=a=>{var p=ls(),M=r(p),P=r(M);t(M),Ut(2),t(p),y(()=>c(P,`ðŸš« ${m().store??""} batch taken!`)),l(a,p)},se=a=>{var p=us(),M=r(p);{var P=Se=>{var We=ds();l(Se,We)};k(M,Se=>{m().recommended&&Se(P)})}var V=s(M,2),L=r(V),H=r(L),q=r(H),ye=r(q,!0);t(q);var K=s(q,2),ce=r(K,!0);t(K),t(H);var ve=s(H,2),_e=s(r(ve),2);{var W=Se=>{var We=cs();l(Se,We)};k(_e,Se=>{m().demand>0&&Se(W)})}t(ve),t(L);var ae=s(L,2),I=s(r(ae),2),R=r(I);t(I),t(ae);var G=s(ae,2),ue=r(G),ke=r(ue),qe=r(ke);t(ke);var he=s(ke,2),Me=r(he);t(he);var ze=s(he,2),Ve=r(ze);t(ze),t(ue);var Ke=s(ue,2);$e(Ke,5,()=>Object.keys(m().items),Ie,(Se,We)=>{var ot=vs(),mt=r(ot);t(ot),y(()=>c(mt,`${m().items[e(We)]??""}x ${e(We)??""}`)),l(Se,ot)}),t(Ke),t(G);var Oe=s(G,2),He=r(Oe),Ct=r(He,!0);t(He),t(Oe),t(V),t(p),y(()=>{Zt(p,"id",F()+"Selected"+e(g)),st(p,1,`relative rounded-2xl bg-white shadow-sm border transition cursor-pointer select-none ${e(g)?"ring-2 ring-green-500 shadow-md":"hover:shadow-md"}`),c(ye,m().store),c(ce,m().city),st(ve,1,`flex flex-wrap gap-1 justify-end ${m().recommended?"mr-24":""}`),c(R,`$${m().earnings??""}`),c(qe,`${e(Ee)??""} total items`),c(Me,`Customer: ${m().name??""}`),c(Ve,`Zone: ${me()??""}`),st(He,1,`rounded-full px-4 py-1.5 text-xs font-semibold transition ${e(g)?"bg-green-600 text-white":"bg-slate-100 text-slate-800 hover:bg-slate-200"}`),c(Ct,e(g)?"Selected âœ“":"Select order")}),Le("click",p,X),l(a,p)};k(be,a=>{e($)?a(de):a(se,!1)})}l(x,re),St(),Pe()}var fs=u('<div class="rounded-2xl bg-white shadow-sm border p-6 text-center space-y-2"><div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 mb-2"><svg class="w-6 h-6 text-blue-600 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div> <p class="text-lg font-semibold text-slate-900"> </p> <p class="text-sm text-slate-500"> </p></div>'),ms=u('<div class="rounded-xl bg-blue-50 border border-blue-200 p-4 mb-4"><p class="text-sm font-medium text-blue-900 text-center"> </p></div>'),xs=u('<button class="rounded-full bg-slate-100 px-4 py-2 text-xs font-medium text-slate-700 hover:bg-slate-200 transition" id="travel"> </button>'),gs=u('<div class="mt-6 flex flex-wrap items-center justify-center gap-3"><button id="startorder" class="rounded-full bg-green-600 px-6 py-2.5 text-sm font-semibold text-white shadow-md hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed"> </button> <!></div>'),bs=u('<!> <div class="flex items-baseline justify-between"><h2 class="text-lg font-semibold text-slate-900">Available batches</h2> <p class="text-xs text-slate-500"> </p></div> <div class="mt-3 grid gap-4 md:grid-cols-2"></div> <!>',1),_s=u('<section class="mx-auto max-w-5xl px-4 py-6 space-y-4"><!></section>');function hs(x,_){kt(_,!1);const[v,Pe]=Tt(),S=()=>w($t,"$currentRound",v),A=()=>w(nt,"$currLocation",v),b=()=>w(Re,"$orders",v),we=()=>w(rt,"$gameText",v),me=()=>w(Ae,"$game",v),xe=()=>w(Nt,"$elapsed",v),Ee=()=>w(at,"$orderList",v),ne=f(),j=f(),m=f(),F=f();let ge=f(!1),g=f(0),T=f(""),h=f(!1),$=f(Kt),z;function le(){const a=pe(Re),p=pe(Ae),M=pe(nt);if(a.length<1){alert(`Please select 1 to ${e(j)} orders!`);return}if(a.length>e(j)){alert(`You can only select up to ${e(j)} orders this round!`);return}if(a.length>1){const P=a[0].store,V=a[0].city;for(let L of a)if(L.store!==P||L.city!==V){alert("Cannot bundle orders from different stores/cities!");return}p.bundled=!0}else p.bundled=!1;a[0].city!=M?C(a[0].city,!0):X()}function C(a,p){let M=e(F).destinations.indexOf(a);M!=-1&&(o(g,e(F).distances[M]),o(ge,!0),o(T,a),setTimeout(()=>{o(ge,!1),nt.set(a),p?X():(ft(Re,[]),o(F,Yt(a)),Fe(rt,J(we).selector="None selected",J(we)))},e(g)*1e3))}function X(){const a=pe(Re);Pr(a,e(m)),Fe(Ae,J(me).inStore=!0,J(me)),Fe(Ae,J(me).inSelect=!1,J(me))}function re(a,p){console.log("updated: "+a+" "+p),at.update(M=>(M[a].earnings=p,M))}jt(()=>{tr.set(xe()),at.set(e(m)),o(h,!0),o($,Kt),z=setInterval(()=>{o($,e($)-1),e($)<=0&&(clearInterval(z),o(h,!1))},1e3)}),At(()=>{z&&clearInterval(z)}),ie(()=>S(),()=>{o(ne,Pt(S()))}),ie(()=>e(ne),()=>{o(j,e(ne).max_bundle??3)}),ie(()=>e(ne),()=>{o(m,e(ne).orders)}),ie(()=>A(),()=>{o(F,Yt(A()))}),Ot(),yt();var be=pt(),de=Je(be);{var se=a=>{var p=_s(),M=r(p);{var P=L=>{var H=fs(),q=s(r(H),2),ye=r(q);t(q);var K=s(q,2),ce=r(K);t(K),t(H),y(()=>{c(ye,`Traveling to ${e(T)??""}`),c(ce,`Est. travel time: ${e(g)??""}s`)}),l(L,H)},V=L=>{var H=bs(),q=Je(H);{var ye=I=>{var R=ms(),G=r(R),ue=r(G);t(G),t(R),y(()=>c(ue,`ðŸ“‹ Review available batches (${e($)??""}s remaining)`)),l(I,R)};k(q,I=>{e(h)&&I(ye)})}var K=s(q,2),ce=s(r(K),2),ve=r(ce);t(ce),t(K);var _e=s(K,2);$e(_e,7,Ee,I=>I.id,(I,R,G)=>{ps(I,{get orderData(){return e(R)},get index(){return e(G)},updateEarnings:re})}),t(_e);var W=s(_e,2);{var ae=I=>{var R=gs(),G=r(R),ue=r(G,!0);t(G);var ke=s(G,2);{var qe=he=>{var Me=pt(),ze=Je(Me);$e(ze,1,()=>e(F).destinations,Ie,(Ve,Ke)=>{var Oe=xs(),He=r(Oe);t(Oe),y(()=>c(He,`Travel to ${e(Ke)??""}`)),Le("click",Oe,()=>C(e(Ke),!1)),l(Ve,Oe)}),l(he,Me)};k(ke,he=>{e(F)&&e(F).destinations&&he(qe)})}t(R),y(()=>{G.disabled=b().length===0,c(ue,we().selector)}),Le("click",G,le),l(I,R)};k(W,I=>{e(h)||I(ae)})}y(()=>c(ve,`Round ${S()??""} â€¢ Select up to ${e(j)??""} ${e(j)===1?"order":"orders"}`)),l(L,H)};k(M,L=>{e(ge)?L(P):L(V,!1)})}t(p),l(a,p)};k(de,a=>{me().inSelect&&a(se)})}l(x,be),St(),Pe()}var $s=u('<div class="container mx-auto px-4 py-6"><div class="text-red-600 font-bold bg-red-100 p-4 rounded"> </div></div>'),ws=u('<button id="start" class="w-full h-12 rounded-xl bg-green-600 hover:bg-green-700 text-white text-base font-semibold shadow-lg hover:shadow-xl transition-all">Enter Simulation</button>'),ys=u('<div class="min-h-screen flex items-center justify-center bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950"><div class="bg-white rounded-3xl shadow-2xl px-12 py-10 w-full max-w-lg"><h1 class="text-3xl font-bold text-center mb-8 text-slate-900">User Access</h1> <!></div></div>'),ks=u('<div class="max-w-xl mx-auto p-6 bg-white rounded-lg shadow-md text-center space-y-6"><h3 class="text-2xl font-bold text-red-600">Game Over!</h3> <div><h4 class="text-xl font-semibold text-gray-800">Your Stats:</h4> <ul class="list-disc list-inside text-left text-gray-700 mt-2 space-y-1"><li><span class="font-medium">Earnings:</span> </li> <li><span class="font-medium">Finished Orders:</span> </li></ul></div> <!></div>'),Os=u('<div class="flex items-center gap-4 text-sm"><div class="flex items-center gap-1.5"><span class="text-slate-700">Time:</span> <span class="font-mono font-semibold text-green-600"> </span></div> <div class="flex items-center gap-1.5"><span class="text-slate-700">Earned:</span> <span class="font-mono font-semibold text-green-600"> </span></div> <div class="flex items-center gap-1.5"><span class="text-slate-700">Location:</span> <span class="text-slate-900"> </span></div></div>'),Ss=u('<header class="sticky top-0 z-50 bg-white/90 backdrop-blur shadow-sm border-b border-slate-200"><div class="mx-auto max-w-5xl px-4 py-3 flex items-center justify-between"><div class="text-sm font-semibold text-red-600">Do not refresh or close the page!</div> <!></div></header> <div class="min-h-screen bg-slate-50 py-6"><!></div>',1),Ts=u('<div class="container mx-auto px-4 py-6"><!></div>');function qs(x,_){kt(_,!1);const[v,Pe]=Tt(),S=()=>w(Ae,"$game",v),A=()=>w(fr,"$globalError",v),b=()=>w(qt,"$GameOver",v),we=()=>w(wt,"$earned",v),me=()=>w(Gt,"$finishedOrders",v),xe=()=>w(Dr,"$remainingTime",v),Ee=()=>w(nt,"$currLocation",v),ne=f(),j=f(),m=f();function F(C){const X=Math.floor(C/60),re=C%60;return`${String(X).padStart(2,"0")}:${String(re).padStart(2,"0")}`}let ge=f(!1);async function g(){await Gr()!=-1&&(Mr(),Er(),Fe(Ae,J(S).inSelect=!0,J(S)),o(ge,!0),ft(at,Xt(Lr)))}function T(C){}jt(()=>(window.addEventListener("click",T),()=>{console.log("listener removed"),window.removeEventListener("click",T)})),ie(()=>S(),()=>{o(ne,S().inSelect)}),ie(()=>S(),()=>{o(j,S().inStore)}),ie(()=>S(),()=>{o(m,S().bundled)}),Ot(),yt();var h=pt(),$=Je(h);{var z=C=>{var X=$s(),re=r(X),be=r(re);t(re),t(X),y(()=>c(be,`âš ï¸ Error: ${A()??""}`)),l(C,X)},le=(C,X)=>{{var re=de=>{var se=ys(),a=r(se),p=s(r(a),2);{var M=P=>{var V=ws();Le("click",V,g),l(P,V)};k(p,P=>{P(M,!1)})}t(a),t(se),l(de,se)},be=de=>{var se=Ts(),a=r(se);{var p=P=>{var V=ks(),L=s(r(V),2),H=s(r(L),2),q=r(H),ye=s(r(q));t(q);var K=s(q,2),ce=s(r(K));t(K),t(H),t(L);var ve=s(L,2);k(ve,_e=>{}),t(V),y(()=>{c(ye,` $${we()??""}`),c(ce,` ${me().length??""}`)}),l(P,V)},M=P=>{var V=Ss(),L=Je(V),H=r(L),q=s(r(H),2);{var ye=W=>{var ae=Os(),I=r(ae),R=s(r(I),2),G=r(R,!0);t(R),t(I);var ue=s(I,2),ke=s(r(ue),2),qe=r(ke);t(ke),t(ue);var he=s(ue,2),Me=s(r(he),2),ze=r(Me,!0);t(Me),t(he),t(ae),y(Ve=>{c(G,Ve),c(qe,`$${we()??""}`),c(ze,Ee())},[()=>F(xe())],ur),l(W,ae)};k(q,W=>{e(ge)&&W(ye)})}t(H),t(L);var K=s(L,2),ce=r(K);{var ve=W=>{hs(W,{})},_e=(W,ae)=>{{var I=R=>{is(R,{})};k(W,R=>{e(j)&&R(I)},ae)}};k(ce,W=>{e(ne)?W(ve):W(_e,!1)})}t(K),l(P,V)};k(a,P=>{b()?P(p):P(M,!1)})}t(se),l(de,se)};k(C,de=>{!e(ge)&&!b()?de(re):de(be,!1)},X)}};k($,C=>{A()?C(z):C(le,!1)})}l(x,h),St(),Pe()}export{qs as component};
